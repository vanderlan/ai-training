# Code Review Agent Template

GitHub-integrated code review agent with production patterns.

## Features

- âœ… Automated PR reviews on GitHub
- âœ… Security vulnerability detection
- âœ… Best practices checking
- âœ… Code quality analysis
- âœ… Automated comment posting
- âœ… Webhook integration
- âœ… Rate limiting per repository
- âœ… Cost tracking

## Quick Start

```bash
# Install dependencies
pip install -r requirements.txt

# Configure
cp .env.example .env
# Add your ANTHROPIC_API_KEY and GITHUB_TOKEN

# Run webhook server
python src/webhook_server.py

# In another terminal, use ngrok for local testing
ngrok http 8000

# Add webhook URL to GitHub:
# https://your-id.ngrok.io/webhooks/github
```

## GitHub Webhook Setup

1. Go to your repository â†’ Settings â†’ Webhooks
2. Click "Add webhook"
3. Set Payload URL: `https://your-domain.com/webhooks/github`
4. Content type: `application/json`
5. Secret: Same as `GITHUB_WEBHOOK_SECRET` in .env
6. Select events: "Pull requests"
7. Save

## What Gets Reviewed

The agent automatically reviews:
- Security vulnerabilities (SQL injection, XSS, etc.)
- Code quality issues
- Best practices violations
- Performance concerns
- Test coverage
- Documentation quality

## Example Review Comment

```markdown
## AI Code Review

### Security Issues (1 High)
- **Line 45**: Potential SQL injection vulnerability
  ```python
  query = f"SELECT * FROM users WHERE id={user_id}"
  ```
  **Recommendation**: Use parameterized queries
  ```python
  query = "SELECT * FROM users WHERE id = ?"
  cursor.execute(query, (user_id,))
  ```

### Code Quality (2 Medium)
- **Line 78**: Function exceeds 50 lines, consider refactoring
- **Line 120**: Missing error handling for API call

### Positive Feedback
- âœ… Good test coverage (85%)
- âœ… Clear function naming
- âœ… Proper type hints

---
ðŸ¤– Generated by Production AI Code Review Agent
```

## Deployment

### Railway
```bash
railway init
railway up
```

### Render
```bash
# Connect GitHub repo to Render
# Uses render.yaml for configuration
```

## Configuration

See `.env.example` for all configuration options.

Key settings:
- `MAX_FILES_PER_PR`: Limit files reviewed per PR
- `REVIEW_TIMEOUT`: Max time for review
- `AUTO_COMMENT`: Automatically post comments
- `SEVERITY_THRESHOLD`: Minimum severity to comment

## Cost Estimation

Typical costs per PR review:
- Small PR (1-5 files): $0.01-0.05
- Medium PR (6-15 files): $0.05-0.15
- Large PR (16+ files): $0.15-0.50

With caching, repeated reviews cost ~$0.001

---

**See `src/` for implementation details and `tests/` for examples.**
